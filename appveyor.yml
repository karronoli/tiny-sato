version: '{build}'
os: unstable
configuration: Release
platform: Any CPU
build:
  project: TinySato.sln
artifacts:
  - path: TinySato/bin/Releases/TinySato.dll
    name: TinySato
cache:
  - LespritV-v12_0_0_50-64bit.zip
install:
  - echo Hello1
  - ps: if (!(Test-Path "LespritV-v12_0_0_50-64bit.zip")) { Invoke-WebRequest -Uri 'http://www.sato.co.jp/download/manual/LespritV-v12_0_0_50-64bit.zip' -OutFile 'LespritV-v12_0_0_50-64bit.zip' }
  - 7z x LespritV-v12_0_0_50-64bit.zip
  - cd LespritV-v12_0_0_50-64bit\LespritV\Driver64
  - echo rundll32
  - echo rundll33
  - echo r undll32
  - ps: cmd /c rundll32 printui.dll PrintUIEntry /if /f LES400V.INF /r FILE: /m "SATO Lesprit408v" /v 2 /b T408v
  - echo Hello2
